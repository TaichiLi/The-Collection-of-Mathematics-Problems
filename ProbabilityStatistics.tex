\chapter{概率论与数理统计}

\section{随机事件与概率}

\subsection{概率的性质}

\begin{proposition}

    证明：
    $$|P(AB) - P(A)P(B)| \leq \dfrac{1}{4}$$

\end{proposition}

\begin{proposition}

    因为
    $$P(AB) - P(A)P(B) = P(AB) + P(A)[P(AB) - P(\overline{A}B)] = P(AB)[1 - P(A)] - P(A)P(\overline{A}B)$$
    且
    $$0 \leq P(AB)[1 - P(A)] \leq P(A)[1 - P(A)]$$
    $$0 \leq P(A)P(\overline{A}B) \leq P(A)P(\overline{A}) = P(A)[1 - P(A)]$$
    所以
    
    \begin{align*}
        |P(AB) - P(A)P(B)| & = |P(AB)[1 - P(A)] - P(A)P(\overline{A}B)| \\
        & \leq \max\{P(AB)[1 - P(A)], P(A)P(\overline{A}B)\} \\
        & \leq P(A)[1 - P(A)] = P(A) - [P(A)]^2 \\
        & = \dfrac{1}{4} - \left[ P(A) - \dfrac{1}{2} \right]^2 \\
        & \leq \dfrac{1}{4}
    \end{align*}

\end{proposition}

\section{随机变量极其分布}

\subsection{随机变量的方差与标准差}

\begin{theorem}[Chebyshev不等式]
    
    设随机变量$X$的数学期望和方差都存在，则对任意常数$\varepsilon > 0$，有
    $$P(|X - E(X)| \geq \varepsilon) \leq \dfrac{Var(X)}{\varepsilon^2}$$

\end{theorem}

\begin{proof}

    设$X$是一个随机变量，其密度函数为$p(x)$。记$E(X) = a$，则有

    \begin{align*}
        P(|X - a| \geq \varepsilon) & = \int_{|x - a| \geq \varepsilon}{p(x)}\diff x \\
        & \leq \int_{|x - a| \geq \varepsilon}{\dfrac{(x - a)^2}{\varepsilon^2}p(x)}\diff x \\
        & \leq \dfrac{1}{\varepsilon^2}\int_{-\infty}^{+\infty}{(x - a)^2p(x)}\diff x \\
        & = \dfrac{Var(X)}{\varepsilon^2}
    \end{align*}
    
\end{proof}

\begin{proposition}
    
    设随机变量$X$仅在区间$[a,b]$上取值，证明：$a \leq E(X) \leq b$，$Var(X) \leq \left(\dfrac{b - a}{2}\right)^2$.

\end{proposition}

\begin{proof}

    设随机变量$X$的密度函数为$p(x)$，则有
    $$E(X) = \int_{a}^{b}{xp(x)}\diff x \leq \int_{a}^{b}{p(x)}\diff x = b$$
    同理$E(X) \geq a$，即$a \leq E(X) \leq b$。
    因为$a \leq X \leq b$，则
    $$-\dfrac{b - a}{2} \leq X - \dfrac{a + b}{2} \leq \dfrac{b - a}{2}$$
    因此
    $$\left(X - \dfrac{a + b}{2}\right)^2 \leq \left(\dfrac{b - a}{2}\right)^2$$
    易知
    $$E\left(X - \dfrac{a + b}{2}\right)^2 \leq \left(\dfrac{b - a}{2}\right)^2$$
    则有
    
    \begin{align*}
        Var(X) & = Var\left(X - \dfrac{a + b}{2}\right) \\
        & = E\left(X - \dfrac{a + b}{2}\right)^2 - \left[E\left(X - \dfrac{a + b}{2}\right)\right]^2 \\
        & \leq E\left(X - \dfrac{a + b}{2}\right)^2 \\
        & \leq \left(\dfrac{b - a}{2}\right)^2
    \end{align*}

\end{proof}

\begin{proposition}

    设$g(x)$为随机变量$X$取值的集合上的非负不减函数，且$E(g(x))$存在。证明：对任意的$\varepsilon > 0$，有
    $$P(X > \varepsilon) \leq \dfrac{E(g(X))}{g(\varepsilon)}$$

\end{proposition}

\begin{proof}

    因为$g(x)$为非负不减函数，则对任意的$\varepsilon > 0$，有
    $$g(x) \geq g(\varepsilon) \leq 0$$
    即$\dfrac{g(x)}{g(\varepsilon)} \leq 1$，因此

    \begin{align*}
        P(X > \varepsilon) & = \int_{\varepsilon}^{+\infty}{p(x)}\diff x \\
        & \leq \int_{\varepsilon}^{+\infty}{\dfrac{g(x)}{g(\varepsilon)}p(x)}\diff x \\
        & \leq \int_{-\infty}^{+\infty}{\dfrac{g(x)}{g(\varepsilon)}p(x)}\diff x \\
        & = \dfrac{\int_{-\infty}^{+\infty}{g(x)p(x)}\diff x}{g(\varepsilon)} \\
        & = \dfrac{E(g(X))}{g(\varepsilon)}
    \end{align*}

\end{proof}

\section{常用离散分布}

\begin{theorem}[Poisson定理]

    在$n$重伯努利试验中，记事件$A$在一次实验中发生的概率为$p_n$（与试验次数有关）。若$\lim\limits_{n \to \infty}{n p_n} = \lambda$，则
    $$\lim\limits_{n \to \infty}{\binom{n}{k}p_n^k(1 - p_n)^{n - k}} = \dfrac{\lambda^k}{k!}\euler^{-\lambda}$$

\end{theorem}

\begin{proof}

    记$n p_n^k = \lambda_n$，即$p_n = \dfrac{\lambda_n}{n}$，则有

    \begin{align*}
        \binom{n}{k}p_n^k(1 - p_n)^{n - k} & = \dfrac{n(n - 1) \cdots (n - k + 1)}{k!}\left(\dfrac{\lambda_n}{n}\right)^k\left(1 - \dfrac{\lambda_n}{n}\right)^{n - k} \\
        & = \dfrac{\lambda_n^k}{k!}\left(1 - \dfrac{1}{n}\right)\left(1 - \dfrac{2}{n}\right) \cdots \left(1 - \dfrac{k - 1}{n}\right)\left(1 - \dfrac{\lambda_n}{n}\right)^{n - k}
    \end{align*}

    对固定的$k$有
    $$\lim\limits_{n \to \infty}{\lambda_n} = \lambda$$
    $$\lim\limits_{n \to \infty}{\left(1 - \dfrac{\lambda_n}{n}\right)^{n - k}} = \euler^{-\lambda}$$
    $$\lim\limits_{n \to \infty}{\left(1 - \dfrac{1}{n}\right)\left(1 - \dfrac{2}{n}\right) \cdots \left(1 - \dfrac{k - 1}{n}\right)} = \dfrac{\lambda^k}{k!}\euler^{-\lambda}$$
    因此，对任意的$k$成立。定理得证。

\end{proof}
